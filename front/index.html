<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cyber Escape - Dossier de conception</title>
    <link rel="stylesheet" href="src/styles.css" />
    <style>
      /* S'assurer que l'écran d'accueil est visible au chargement */
      #welcome-screen {
        display: flex !important;
        z-index: 10 !important;
      }
      #desktop-screen {
        z-index: 1 !important;
      }

      /* Quand l'écran bureau est actif, il doit être au-dessus */
      #desktop-screen.active {
        z-index: 20 !important;
      }

      /* L'écran de victoire doit être au-dessus de tout */
      #victory-screen.active {
        z-index: 50 !important;
      }

      /* L'écran d'accueil ne doit pas être au-dessus de la victoire */
      #welcome-screen:not(.active) {
        z-index: 1 !important;
        display: none !important;
      }

      /* Forcer la fermeture de la modale de déverrouillage */
      .modal.force-hidden {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
      }
    </style>
  </head>
  <body>
    <!-- Écran d'accueil -->
    <div id="welcome-screen" class="screen active">
      <div class="welcome-container">
        <div class="logo">
          <h1>🔒 Cyber Escape</h1>
          <p class="subtitle">Dossier de conception</p>
        </div>
        <div class="welcome-content">
          <p class="description">
            Un hacker a verrouillé le réseau du lycée !<br />
            Trouve les indices cachés pour déverrouiller le système.
          </p>
          <div class="welcome-buttons">
            <button id="start-btn" class="btn btn-primary">Démarrer</button>
            <button id="help-btn" class="btn btn-secondary">
              Comment jouer
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Écran bureau -->
    <div id="desktop-screen" class="screen">
      <div class="desktop-header">
        <div class="timer">
          <span id="timer-display">15:00</span>
        </div>
        <button id="unlock-btn" class="btn btn-unlock" disabled>
          🔓 Déverrouiller
        </button>
        <button
          onclick="showScreen('welcome')"
          style="
            background: #2196f3;
            color: white;
            padding: 5px 10px;
            margin-left: 10px;
            border: none;
            border-radius: 3px;
          "
        >
          🏠 Accueil
        </button>
      </div>

      <div class="desktop-background">
        <div class="desktop-icons">
          <div class="desktop-icon" data-puzzle="documents">
            <div class="icon">📁</div>
            <span>Documents</span>
            <div class="puzzle-status" id="doc-status"></div>
          </div>
          <div class="desktop-icon" data-puzzle="images">
            <div class="icon">🖼️</div>
            <span>Images</span>
            <div class="puzzle-status" id="img-status"></div>
          </div>
          <div class="desktop-icon" data-puzzle="mail">
            <div class="icon">📧</div>
            <span>Mail</span>
            <div class="puzzle-status" id="mail-status"></div>
          </div>
          <div class="desktop-icon" data-puzzle="cipher">
            <div class="icon">🔐</div>
            <span>Chiffrement</span>
            <div class="puzzle-status" id="cipher-status"></div>
          </div>
          <div class="desktop-icon" data-puzzle="usb">
            <div class="icon">💾</div>
            <span>USB</span>
            <div class="puzzle-status" id="usb-status"></div>
          </div>
          <div class="desktop-icon" data-puzzle="update">
            <div class="icon">🔄</div>
            <span>Mise à jour</span>
            <div class="puzzle-status" id="update-status"></div>
          </div>
          <div class="desktop-icon" data-puzzle="social">
            <div class="icon">🎭</div>
            <span>Ingénierie sociale</span>
            <div class="puzzle-status" id="social-status"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modales des énigmes -->
    <div id="puzzle-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="puzzle-title">Énigme</h2>
          <div class="modal-controls">
            <button id="hint-btn" class="btn btn-hint">💡 Indice</button>
            <button id="close-puzzle" class="btn btn-close">✕</button>
          </div>
        </div>
        <div class="modal-body">
          <!-- Contenu dynamique des énigmes -->
          <div id="puzzle-content"></div>
        </div>
      </div>
    </div>

    <!-- Modale de déverrouillage -->
    <div id="unlock-modal" class="modal">
      <div class="modal-content unlock-modal">
        <div class="modal-header">
          <h2>🔓 Déverrouiller le réseau</h2>
          <button id="close-unlock" class="btn btn-close">✕</button>
        </div>
        <div class="modal-body">
          <p>Entrez le code à 7 chiffres :</p>
          <div class="code-input">
            <input
              type="text"
              id="code-input"
              maxlength="7"
              placeholder="0000000"
            />
          </div>
          <div class="code-display">
            <div class="code-digit" data-digit="1">_</div>
            <div class="code-digit" data-digit="2">_</div>
            <div class="code-digit" data-digit="3">_</div>
            <div class="code-digit" data-digit="4">_</div>
            <div class="code-digit" data-digit="5">_</div>
            <div class="code-digit" data-digit="6">_</div>
            <div class="code-digit" data-digit="7">_</div>
          </div>
          <button id="submit-code" class="btn btn-primary">Valider</button>
        </div>
      </div>
    </div>

    <!-- Écran de victoire -->
    <div id="victory-screen" class="screen">
      <div class="victory-container">
        <div class="victory-content">
          <h1>🎉 Félicitations !</h1>
          <p class="victory-message">
            Vous avez déverrouillé le réseau du lycée !
          </p>
          <div class="victory-stats">
            <div class="stat">
              <span class="stat-label">Temps restant :</span>
              <span id="time-remaining">--:--</span>
            </div>
            <div class="stat">
              <span class="stat-label">Indices utilisés :</span>
              <span id="hints-used">0/3</span>
            </div>
          </div>
          <div class="educational-message">
            <h3>💡 Message pédagogique</h3>
            <p>
              Vous venez de découvrir les bases de la cybersécurité !<br />
              Restez vigilant face aux emails suspects, vérifiez toujours les
              sources,<br />
              et gardez un esprit critique sur le web.
            </p>
          </div>
          <button id="play-again" class="btn btn-primary">Rejouer</button>
        </div>
      </div>
    </div>

    <!-- Modale d'aide -->
    <div id="help-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Comment jouer</h2>
          <button id="close-help" class="btn btn-close">✕</button>
        </div>
        <div class="modal-body">
          <div class="help-content">
            <h3>🎯 Objectif</h3>
            <p>
              Trouvez 7 indices cachés dans les dossiers pour composer un code à
              7 chiffres.
            </p>

            <h3>📁 Documents</h3>
            <p>Lisez le rapport et trouvez le mot caché daans ce texte.</p>

            <h3>🖼️ Images</h3>
            <p>
              Réglez la luminosité et le contraste pour révéler le message caché
              dans l'image.
            </p>

            <h3>📧 Mail</h3>
            <p>
              Identifiez les X erreurs dans l'email suspect pour obtenir
              l'indice final.
            </p>

            <h3>🔐 Chiffrement</h3>
            <p>
              Déchiffrez le message codé en utilisant le chiffrement de César
              pour obtenir le dernier chiffre du code.
            </p>

            <h3>💾 USB</h3>
            <p>
              Analysez les fichiers sur les clés USB pour identifier les
              éléments les plus critiques pour la sécurité.
            </p>

            <h3>🔄 Mise à jour</h3>
            <p>
              Identifiez les versions logicielles, les vrais patches de sécurité
              et les serveurs compromis dans les logs.
            </p>

            <h3>🎭 Ingénierie sociale</h3>
            <p>
              Détectez les tentatives de manipulation psychologique pour obtenir
              des codes d'accès et des informations sensibles.
            </p>

            <h3>⏰ Temps</h3>
            <p>Vous avez 15 minutes pour résoudre toutes les énigmes !</p>
          </div>
        </div>
      </div>
    </div>

    <script src="src/main.js"></script>
    <script src="src/puzzles/doc.js"></script>
    <script src="src/puzzles/image.js"></script>
    <script src="src/puzzles/mail.js"></script>
    <script src="src/puzzles/cipher.js"></script>
    <script src="src/puzzles/usb.js"></script>
    <script src="src/puzzles/update.js"></script>
    <script src="src/puzzles/social.js"></script>
  </body>
</html>
